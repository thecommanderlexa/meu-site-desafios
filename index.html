<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Desafio Entre Amigos</title>
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="shortcut icon" href="/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <meta name="apple-mobile-web-app-title" content="MyWebSite" />
    <link rel="manifest" href="/site.webmanifest" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone@7/babel.min.js"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Ícones SVG simples
        const Icons = {
          Trophy: () => <svg className="inline" width="32" height="32" fill="currentColor" viewBox="0 0 24 24"><path d="M6 2h12v2h2a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2h-2.528A5 5 0 0 1 13 15.938V18h2v2H9v-2h2v-2.062A5 5 0 0 1 6.528 12H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2V2zm14 4h-2v4h2V6zM4 6v4h2V6H4zm4-2v8a3 3 0 1 0 6 0V4H8z"/></svg>,
          Plus: ({size = 20}) => <svg className="inline" width={size} height={size} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 4v16m8-8H4"/></svg>,
          Users: ({size = 20}) => <svg className="inline" width={size} height={size} fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/></svg>,
          Target: ({size = 20}) => <svg className="inline" width={size} height={size} fill="none" stroke="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" strokeWidth={2}/><circle cx="12" cy="12" r="6" strokeWidth={2}/><circle cx="12" cy="12" r="2" strokeWidth={2}/></svg>,
          Calendar: ({size = 20}) => <svg className="inline" width={size} height={size} fill="none" stroke="currentColor" viewBox="0 0 24 24"><rect x="3" y="4" width="18" height="18" rx="2" ry="2" strokeWidth={2}/><line x1="16" y1="2" x2="16" y2="6" strokeWidth={2}/><line x1="8" y1="2" x2="8" y2="6" strokeWidth={2}/><line x1="3" y1="10" x2="21" y2="10" strokeWidth={2}/></svg>,
          TrendingUp: ({size = 20}) => <svg className="inline" width={size} height={size} fill="none" stroke="currentColor" viewBox="0 0 24 24"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18" strokeWidth={2}/><polyline points="17 6 23 6 23 12" strokeWidth={2}/></svg>,
          ChevronRight: ({size = 20}) => <svg className="inline" width={size} height={size} fill="none" stroke="currentColor" viewBox="0 0 24 24"><polyline points="9 18 15 12 9 6" strokeWidth={2}/></svg>,
          Trash: ({size = 20}) => <svg className="inline" width={size} height={size} fill="none" stroke="currentColor" viewBox="0 0 24 24"><polyline points="3 6 5 6 21 6" strokeWidth={2}/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" strokeWidth={2}/></svg>,
          Check: ({size = 20}) => <svg className="inline" width={size} height={size} fill="none" stroke="currentColor" viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12" strokeWidth={2}/></svg>,
          X: ({size = 20}) => <svg className="inline" width={size} height={size} fill="none" stroke="currentColor" viewBox="0 0 24 24"><line x1="18" y1="6" x2="6" y2="18" strokeWidth={2}/><line x1="6" y1="6" x2="18" y2="18" strokeWidth={2}/></svg>,
          Share: ({size = 20}) => <svg className="inline" width={size} height={size} fill="none" stroke="currentColor" viewBox="0 0 24 24"><circle cx="18" cy="5" r="3" strokeWidth={2}/><circle cx="6" cy="12" r="3" strokeWidth={2}/><circle cx="18" cy="19" r="3" strokeWidth={2}/><line x1="8.59" y1="13.51" x2="15.42" y2="17.49" strokeWidth={2}/><line x1="15.41" y1="6.51" x2="8.59" y2="10.49" strokeWidth={2}/></svg>,
          Copy: ({size = 20}) => <svg className="inline" width={size} height={size} fill="none" stroke="currentColor" viewBox="0 0 24 24"><rect x="9" y="9" width="13" height="13" rx="2" ry="2" strokeWidth={2}/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" strokeWidth={2}/></svg>
        };

        function App() {
          const [view, setView] = useState('home');
          const [challenges, setChallenges] = useState([]);
          const [currentChallenge, setCurrentChallenge] = useState(null);
          const [userName, setUserName] = useState('');
          const [isNameSet, setIsNameSet] = useState(false);
          const [loading, setLoading] = useState(true);
          const [showJoinModal, setShowJoinModal] = useState(false);

          useEffect(() => {
            const savedName = localStorage.getItem('user-name');
            if (savedName) {
              setUserName(savedName);
              setIsNameSet(true);
            }

            const savedChallenges = localStorage.getItem('all-challenges');
            if (savedChallenges) {
              setChallenges(JSON.parse(savedChallenges));
            }
            setLoading(false);
          }, []);

          const saveChallenges = (newChallenges) => {
            setChallenges(newChallenges);
            localStorage.setItem('all-challenges', JSON.stringify(newChallenges));
          };

          const saveUserName = (name) => {
            setUserName(name);
            setIsNameSet(true);
            localStorage.setItem('user-name', name);
          };

          const joinChallengeByCode = (code) => {
            const challenge = challenges.find(c => c.id === code);
            if (challenge) {
              if (!challenge.participants.find(p => p.name === userName)) {
                const updatedChallenge = { ...challenge };
                updatedChallenge.participants.push({ name: userName, progress: [] });
                updatedChallenge.updates = [{
                  user: userName,
                  action: 'joined',
                  date: new Date().toISOString()
                }, ...(updatedChallenge.updates || [])];
                
                const newChallenges = challenges.map(c => c.id === code ? updatedChallenge : c);
                saveChallenges(newChallenges);
                setCurrentChallenge(updatedChallenge);
                setView('detail');
                setShowJoinModal(false);
              } else {
                alert('Você já está neste desafio!');
              }
            } else {
              alert('Código inválido!');
            }
          };

          if (loading) {
            return <div className="min-h-screen bg-gradient-to-br from-purple-600 to-blue-600 flex items-center justify-center">
              <div className="text-white text-xl">Carregando...</div>
            </div>;
          }

          if (!isNameSet) {
            return <NameSetup onNameSet={saveUserName} />;
          }

          if (view === 'create') {
            return <CreateChallenge 
              onBack={() => setView('home')} 
              onSave={(challenge) => {
                const newChallenges = [...challenges, { 
                  ...challenge, 
                  id: Date.now().toString(), 
                  participants: [{ name: userName, progress: [] }], 
                  updates: [] 
                }];
                saveChallenges(newChallenges);
                setView('home');
              }} 
            />;
          }

          if (view === 'detail' && currentChallenge) {
            return <ChallengeDetail 
              challenge={currentChallenge} 
              userName={userName}
              onBack={() => {
                setView('home');
                setCurrentChallenge(null);
              }}
              onUpdate={(updatedChallenge) => {
                const newChallenges = challenges.map(c => c.id === updatedChallenge.id ? updatedChallenge : c);
                saveChallenges(newChallenges);
                setCurrentChallenge(updatedChallenge);
              }}
              onDelete={(id) => {
                const newChallenges = challenges.filter(c => c.id !== id);
                saveChallenges(newChallenges);
                setView('home');
                setCurrentChallenge(null);
              }}
            />;
          }

          return (
            <div className="min-h-screen bg-gradient-to-br from-purple-600 to-blue-600 p-4">
              <div className="max-w-4xl mx-auto">
                <div className="bg-white rounded-2xl shadow-2xl p-6 mb-6">
                  <div className="flex items-center justify-between mb-4">
                    <div>
                      <h1 className="text-3xl font-bold text-gray-800 flex items-center gap-2">
                        <Icons.Trophy />
                        Desafio Entre Amigos
                      </h1>
                      <p className="text-gray-600 mt-1">Olá, {userName}! 👋</p>
                    </div>
                    <button
                      onClick={() => setView('create')}
                      className="bg-gradient-to-r from-purple-500 to-blue-500 text-white px-6 py-3 rounded-xl font-semibold hover:shadow-lg transition-all flex items-center gap-2"
                    >
                      <Icons.Plus size={20} />
                      Criar Desafio
                    </button>
                  </div>
                  
                  <button
                    onClick={() => setShowJoinModal(true)}
                    className="w-full bg-green-500 text-white px-6 py-3 rounded-xl font-semibold hover:bg-green-600 transition-all flex items-center justify-center gap-2 mt-4"
                  >
                    <Icons.Users size={20} />
                    Entrar em um Desafio
                  </button>
                </div>

                {showJoinModal && <JoinModal onClose={() => setShowJoinModal(false)} onJoin={joinChallengeByCode} />}

                <div className="grid gap-4">
                  {challenges.length === 0 ? (
                    <div className="bg-white rounded-2xl shadow-xl p-12 text-center">
                      <Icons.Target size={64} />
                      <h2 className="text-2xl font-bold text-gray-800 mb-2 mt-4">Nenhum desafio ainda</h2>
                      <p className="text-gray-600 mb-6">Crie seu primeiro desafio e convide seus amigos!</p>
                      <button
                        onClick={() => setView('create')}
                        className="bg-gradient-to-r from-purple-500 to-blue-500 text-white px-8 py-3 rounded-xl font-semibold hover:shadow-lg transition-all"
                      >
                        Criar Primeiro Desafio
                      </button>
                    </div>
                  ) : (
                    challenges.map(challenge => (
                      <ChallengeCard
                        key={challenge.id}
                        challenge={challenge}
                        userName={userName}
                        onClick={() => {
                          setCurrentChallenge(challenge);
                          setView('detail');
                        }}
                      />
                    ))
                  )}
                </div>
              </div>
            </div>
          );
        }

        function JoinModal({ onClose, onJoin }) {
          const [code, setCode] = useState('');

          return (
            <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
              <div className="bg-white rounded-2xl p-6 max-w-md w-full">
                <div className="flex items-center justify-between mb-4">
                  <h3 className="text-xl font-bold text-gray-800">Entrar em um Desafio</h3>
                  <button onClick={onClose} className="text-gray-500 hover:text-gray-700">
                    <Icons.X size={24} />
                  </button>
                </div>
                
                <p className="text-gray-600 mb-4">Digite o código do desafio:</p>
                
                <input
                  type="text"
                  value={code}
                  onChange={(e) => setCode(e.target.value)}
                  placeholder="Cole o código aqui"
                  className="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:border-purple-500 focus:outline-none mb-4"
                  onKeyPress={(e) => e.key === 'Enter' && code.trim() && onJoin(code.trim())}
                />
                
                <button
                  onClick={() => code.trim() && onJoin(code.trim())}
                  disabled={!code.trim()}
                  className="w-full bg-gradient-to-r from-purple-500 to-blue-500 text-white px-6 py-3 rounded-xl font-semibold hover:shadow-lg transition-all disabled:opacity-50"
                >
                  Entrar no Desafio
                </button>
              </div>
            </div>
          );
        }

        function NameSetup({ onNameSet }) {
          const [name, setName] = useState('');

          return (
            <div className="min-h-screen bg-gradient-to-br from-purple-600 to-blue-600 flex items-center justify-center p-4">
              <div className="bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full">
                <Icons.Trophy />
                <h1 className="text-3xl font-bold text-gray-800 text-center mb-2 mt-4">Bem-vindo!</h1>
                <p className="text-gray-600 text-center mb-6">Como você gostaria de ser chamado?</p>
                <input
                  type="text"
                  value={name}
                  onChange={(e) => setName(e.target.value)}
                  placeholder="Seu nome ou apelido"
                  className="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:border-purple-500 focus:outline-none mb-4"
                  onKeyPress={(e) => e.key === 'Enter' && name.trim() && onNameSet(name.trim())}
                />
                <button
                  onClick={() => name.trim() && onNameSet(name.trim())}
                  disabled={!name.trim()}
                  className="w-full bg-gradient-to-r from-purple-500 to-blue-500 text-white px-6 py-3 rounded-xl font-semibold hover:shadow-lg transition-all disabled:opacity-50"
                >
                  Começar
                </button>
              </div>
            </div>
          );
        }

        function CreateChallenge({ onBack, onSave }) {
          const [title, setTitle] = useState('');
          const [description, setDescription] = useState('');
          const [goal, setGoal] = useState('');
          const [unit, setUnit] = useState('');
          const [startDate, setStartDate] = useState('');
          const [endDate, setEndDate] = useState('');
          const [type, setType] = useState('competitive');

          const handleSubmit = () => {
            if (!title || !goal || !unit || !startDate || !endDate) return;
            onSave({ title, description, goal: parseFloat(goal), unit, startDate, endDate, type, createdAt: new Date().toISOString() });
          };

          return (
            <div className="min-h-screen bg-gradient-to-br from-purple-600 to-blue-600 p-4">
              <div className="max-w-2xl mx-auto">
                <div className="bg-white rounded-2xl shadow-2xl p-6">
                  <button onClick={onBack} className="text-gray-600 hover:text-gray-800 mb-4">← Voltar</button>
                  
                  <h2 className="text-2xl font-bold text-gray-800 mb-6">Criar Novo Desafio</h2>

                  <div className="space-y-4">
                    <div>
                      <label className="block text-sm font-semibold text-gray-700 mb-2">Título do Desafio</label>
                      <input
                        type="text"
                        value={title}
                        onChange={(e) => setTitle(e.target.value)}
                        placeholder="Ex: Beber 8 copos de água por dia"
                        className="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:border-purple-500 focus:outline-none"
                      />
                    </div>

                    <div>
                      <label className="block text-sm font-semibold text-gray-700 mb-2">Descrição (opcional)</label>
                      <textarea
                        value={description}
                        onChange={(e) => setDescription(e.target.value)}
                        placeholder="Detalhes sobre o desafio..."
                        className="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:border-purple-500 focus:outline-none"
                        rows="3"
                      />
                    </div>

                    <div className="grid grid-cols-2 gap-4">
                      <div>
                        <label className="block text-sm font-semibold text-gray-700 mb-2">Meta</label>
                        <input
                          type="number"
                          value={goal}
                          onChange={(e) => setGoal(e.target.value)}
                          placeholder="8"
                          className="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:border-purple-500 focus:outline-none"
                        />
                      </div>

                      <div>
                        <label className="block text-sm font-semibold text-gray-700 mb-2">Unidade</label>
                        <input
                          type="text"
                          value={unit}
                          onChange={(e) => setUnit(e.target.value)}
                          placeholder="copos de água"
                          className="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:border-purple-500 focus:outline-none"
                        />
                      </div>
                    </div>

                    <div className="grid grid-cols-2 gap-4">
                      <div>
                        <label className="block text-sm font-semibold text-gray-700 mb-2">Data de Início</label>
                        <input
                          type="date"
                          value={startDate}
                          onChange={(e) => setStartDate(e.target.value)}
                          className="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:border-purple-500 focus:outline-none"
                        />
                      </div>

                      <div>
                        <label className="block text-sm font-semibold text-gray-700 mb-2">Data de Término</label>
                        <input
                          type="date"
                          value={endDate}
                          onChange={(e) => setEndDate(e.target.value)}
                          className="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:border-purple-500 focus:outline-none"
                        />
                      </div>
                    </div>

                    <div>
                      <label className="block text-sm font-semibold text-gray-700 mb-2">Tipo de Desafio</label>
                      <div className="grid grid-cols-2 gap-4">
                        <button
                          onClick={() => setType('competitive')}
                          className={`px-4 py-3 rounded-xl font-semibold transition-all ${
                            type === 'competitive'
                              ? 'bg-gradient-to-r from-purple-500 to-blue-500 text-white shadow-lg'
                              : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                          }`}
                        >
                          Competitivo
                        </button>
                        <button
                          onClick={() => setType('collaborative')}
                          className={`px-4 py-3 rounded-xl font-semibold transition-all ${
                            type === 'collaborative'
                              ? 'bg-gradient-to-r from-purple-500 to-blue-500 text-white shadow-lg'
                              : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                          }`}
                        >
                          Colaborativo
                        </button>
                      </div>
                    </div>

                    <button
                      onClick={handleSubmit}
                      disabled={!title || !goal || !unit || !startDate || !endDate}
                      className="w-full bg-gradient-to-r from-purple-500 to-blue-500 text-white px-6 py-4 rounded-xl font-semibold hover:shadow-lg transition-all disabled:opacity-50 mt-6"
                    >
                      Criar Desafio
                    </button>
                  </div>
                </div>
              </div>
            </div>
          );
        }

        function ChallengeCard({ challenge, userName, onClick }) {
          const today = new Date();
          const start = new Date(challenge.startDate);
          const end = new Date(challenge.endDate);
          const daysRemaining = Math.ceil((end - today) / (1000 * 60 * 60 * 24));
          const status = today < start ? 'upcoming' : today > end ? 'ended' : 'active';

          const userParticipant = challenge.participants.find(p => p.name === userName);
          const totalProgress = userParticipant?.progress.reduce((sum, p) => sum + p.value, 0) || 0;
          const progressPercent = Math.min((totalProgress / challenge.goal) * 100, 100);

          return (
            <div onClick={onClick} className="bg-white rounded-2xl shadow-xl p-6 hover:shadow-2xl transition-all cursor-pointer">
              <div className="flex items-start justify-between mb-4">
                <div className="flex-1">
                  <h3 className="text-xl font-bold text-gray-800 mb-1">{challenge.title}</h3>
                  {challenge.description && <p className="text-gray-600 text-sm">{challenge.description}</p>}
                </div>
                <div className={`px-3 py-1 rounded-full text-xs font-semibold ${
                  status === 'active' ? 'bg-green-100 text-green-700' :
                  status === 'upcoming' ? 'bg-blue-100 text-blue-700' :
                  'bg-gray-100 text-gray-700'
                }`}>
                  {status === 'active' ? 'Ativo' : status === 'upcoming' ? 'Em breve' : 'Finalizado'}
                </div>
              </div>

              <div className="grid grid-cols-3 gap-4 mb-4">
                <div className="bg-purple-50 rounded-xl p-3">
                  <div className="flex items-center gap-2 text-purple-600 mb-1">
                    <Icons.Target size={16} />
                    <span className="text-xs font-semibold">Meta</span>
                  </div>
                  <p className="text-lg font-bold text-gray-800">{challenge.goal} {challenge.unit}</p>
                </div>

                <div className="bg-blue-50 rounded-xl p-3">
                  <div className="flex items-center gap-2 text-blue-600 mb-1">
                    <Icons.Calendar size={16} />
                    <span className="text-xs font-semibold">Tempo</span>
                  </div>
                  <p className="text-lg font-bold text-gray-800">
                    {status === 'active' ? `${daysRemaining}d` : status === 'upcoming' ? 'Em breve' : 'Fim'}
                  </p>
                </div>

                <div className="bg-green-50 rounded-xl p-3">
                  <div className="flex items-center gap-2 text-green-600 mb-1">
                    <Icons.Users size={16} />
                    <span className="text-xs font-semibold">Pessoas</span>
                  </div>
                  <p className="text-lg font-bold text-gray-800">{challenge.participants.length}</p>
                </div>
              </div>

              <div className="mb-3">
                <div className="flex justify-between text-sm mb-2">
                  <span className="text-gray-600">Seu progresso</span>
                  <span className="font-bold text-gray-800">{totalProgress.toFixed(1)} / {challenge.goal}</span>
                </div>
                <div className="w-full bg-gray-200 rounded-full h-3">
                  <div 
                    className="bg-gradient-to-r from-purple-500 to-blue-500 h-3 rounded-full transition-all"
                    style={{ width: `${progressPercent}%` }}
                  />
                </div>
              </div>

              <div className="flex items-center justify-between text-sm text-gray-600">
                <span>{new Date(challenge.startDate).toLocaleDateString('pt-BR')} - {new Date(challenge.endDate).toLocaleDateString('pt-BR')}</span>
                <Icons.ChevronRight size={20} />
              </div>
            </div>
          );
        }

        function ChallengeDetail({ challenge, userName, onBack, onUpdate, onDelete }) {
          const [showAddProgress, setShowAddProgress] = useState(false);
          const [progressValue, setProgressValue] = useState('');
          const [showShareModal, setShowShareModal] = useState(false);
          const [copied, setCopied] = useState(false);

          const userParticipant = challenge.participants.find(p => p.name === userName);
          const totalProgress = userParticipant?.progress.reduce((sum, p) => sum + p.value, 0) || 0;

          const copyCode = () => {
            navigator.clipboard.writeText(challenge.id);
            setCopied(true);
            setTimeout(() => setCopied(false), 2000);
          };

          const handleAddProgress = () => {
            if (!progressValue || parseFloat(progressValue) <= 0) return;

            const updatedChallenge = { ...challenge };
            const participantIndex = updatedChallenge.participants.findIndex(p => p.name === userName);
            
            if (participantIndex !== -1) {
              updatedChallenge.participants[participantIndex].progress.push({
                value: parseFloat(progressValue),
                date: new Date().toISOString()
              });

              updatedChallenge.updates = [{
                user: userName,
                action: 'added_progress',
                value: parseFloat(progressValue),
                date: new Date().toISOString()
              }, ...(updatedChallenge.updates || [])];

              onUpdate(updatedChallenge);
              setProgressValue('');
              setShowAddProgress(false);
            }
          };

          const sortedParticipants = [...challenge.participants].sort((a, b) => {
            const totalA = a.progress.reduce((sum, p) => sum + p.value, 0);
            const totalB = b.progress.reduce((sum, p) => sum + p.value, 0);
            return totalB - totalA;
          });

          return (
            <div className="min-h-screen bg-gradient-to-br from-purple-600 to-blue-600 p-4">
              <div className="max-w-4xl mx-auto">
                <div className="bg-white rounded-2xl shadow-2xl p-6 mb-6">
                  <div className="flex items-center justify-between mb-4">
                    <button onClick={onBack} className="text-gray-600 hover:text-gray-800">← Voltar</button>
                    <div className="flex items-center gap-2">
                      <button
                        onClick={() => setShowShareModal(true)}
                        className="bg-blue-500 text-white px-4 py-2 rounded-xl hover:bg-blue-600 transition-all flex items-center gap-2 text-sm font-semibold"
                      >
                        <Icons.Share size={18} />
                        Convidar
                      </button>
                      <button
                        onClick={() => window.confirm('Tem certeza?') && onDelete(challenge.id)}
                        className="text-red-500 hover:text-red-700 p-2"
                      >
                        <Icons.Trash size={20} />
                      </button>
                    </div>
                  </div>

                  <h1 className="text-3xl font-bold text-gray-800 mb-2">{challenge.title}</h1>
                  {challenge.description && <p className="text-gray-600 mb-4">{challenge.description}</p>}

                  <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                    <div className="bg-purple-50 rounded-xl p-4">
                      <div className="flex items-center gap-2 text-purple-600 mb-2">
                        <Icons.Target size={20} />
                        <span className="text-sm font-semibold">Meta</span>
                      </div>
                      <p className="text-2xl font-bold text-gray-800">{challenge.goal}</p>
                      <p className="text-sm text-gray-600">{challenge.unit}</p>
                    </div>

                    <div className="bg-blue-50 rounded-xl p-4">
                      <div className="flex items-center gap-2 text-blue-600 mb-2">
                        <Icons.TrendingUp size={20} />
                        <span className="text-sm font-semibold">Seu Total</span>
                      </div>
                      <p className="text-2xl font-bold text-gray-800">{totalProgress.toFixed(1)}</p>
                      <p className="text-sm text-gray-600">{((totalProgress / challenge.goal) * 100).toFixed(0)}%</p>
                    </div>

                    <div className="bg-green-50 rounded-xl p-4">
                      <div className="flex items-center gap-2 text-green-600 mb-2">
                        <Icons.Users size={20} />
                        <span className="text-sm font-semibold">Participantes</span>
                      </div>
                      <p className="text-2xl font-bold text-gray-800">{challenge.participants.length}</p>
                    </div>

                    <div className="bg-yellow-50 rounded-xl p-4">
                      <div className="flex items-center gap-2 text-yellow-600 mb-2">
                        <Icons.Calendar size={20} />
                        <span className="text-sm font-semibold">Tipo</span>
                      </div>
                      <p className="text-lg font-bold text-gray-800">
                        {challenge.type === 'competitive' ? 'Competitivo' : 'Colaborativo'}
                      </p>
                    </div>
                  </div>

                  <button
                    onClick={() => setShowAddProgress(!showAddProgress)}
                    className="w-full bg-gradient-to-r from-purple-500 to-blue-500 text-white px-6 py-4 rounded-xl font-semibold hover:shadow-lg transition-all mb-4"
                  >
                    <Icons.Plus size={20} />
                    {' '}Adicionar Progresso
                  </button>

                  {showAddProgress && (
                    <div className="bg-gray-50 rounded-xl p-4 mb-4">
                      <div className="flex gap-2">
                        <input
                          type="number"
                          value={progressValue}
                          onChange={(e) => setProgressValue(e.target.value)}
                          placeholder={`Quantidade em ${challenge.unit}`}
                          className="flex-1 px-4 py-3 border-2 border-gray-300 rounded-xl focus:border-purple-500 focus:outline-none"
                          onKeyPress={(e) => e.key === 'Enter' && handleAddProgress()}
                        />
                        <button
                          onClick={handleAddProgress}
                          className="bg-green-500 text-white px-6 py-3 rounded-xl font-semibold hover:bg-green-600"
                        >
                          <Icons.Check size={20} />
                        </button>
                        <button
                          onClick={() => {
                            setShowAddProgress(false);
                            setProgressValue('');
                          }}
                          className="bg-gray-300 text-gray-700 px-6 py-3 rounded-xl font-semibold hover:bg-gray-400"
                        >
                          <Icons.X size={20} />
                        </button>
                      </div>
                    </div>
                  )}
                </div>

                <div className="bg-white rounded-2xl shadow-2xl p-6 mb-6">
                  <h2 className="text-xl font-bold text-gray-800 mb-4">Ranking</h2>
                  <div className="space-y-3">
                    {sortedParticipants.map((participant, index) => {
                      const total = participant.progress.reduce((sum, p) => sum + p.value, 0);
                      const percent = Math.min((total / challenge.goal) * 100, 100);

                      return (
                        <div key={participant.name} className="bg-gray-50 rounded-xl p-4">
                          <div className="flex items-center justify-between mb-2">
                            <div className="flex items-center gap-3">
                              <div className={`w-8 h-8 rounded-full flex items-center justify-center font-bold text-white ${
                                index === 0 ? 'bg-yellow-500' :
                                index === 1 ? 'bg-gray-400' :
                                index === 2 ? 'bg-orange-600' :
                                'bg-gray-300'
                              }`}>
                                {index + 1}
                              </div>
                              <span className="font-semibold text-gray-800">{participant.name}</span>
                              {participant.name === userName && (
                                <span className="text-xs bg-purple-100 text-purple-700 px-2 py-1 rounded-full">Você</span>
                              )}
                            </div>
                            <span className="font-bold text-gray-800">{total.toFixed(1)} / {challenge.goal}</span>
                          </div>
                          <div className="w-full bg-gray-200 rounded-full h-2">
                            <div 
                              className="bg-gradient-to-r from-purple-500 to-blue-500 h-2 rounded-full transition-all"
                              style={{ width: `${percent}%` }}
                            />
                          </div>
                        </div>
                      );
                    })}
                  </div>
                </div>

                {challenge.updates && challenge.updates.length > 0 && (
                  <div className="bg-white rounded-2xl shadow-2xl p-6">
                    <h2 className="text-xl font-bold text-gray-800 mb-4">Atualizações Recentes</h2>
                    <div className="space-y-3">
                      {challenge.updates.slice(0, 10).map((update, index) => (
                        <div key={index} className="flex items-start gap-3 text-sm">
                          <div className="w-2 h-2 bg-purple-500 rounded-full mt-2" />
                          <div>
                            <span className="font-semibold text-gray-800">{update.user}</span>
                            {update.action === 'added_progress' && (
                              <span className="text-gray-600"> adicionou {update.value} {challenge.unit}</span>
                            )}
                            {update.action === 'joined' && (
                              <span className="text-gray-600"> entrou no desafio</span>
                            )}
                            <p className="text-gray-500 text-xs mt-1">
                              {new Date(update.date).toLocaleString('pt-BR', { 
                                day: '2-digit', 
                                month: '2-digit', 
                                hour: '2-digit', 
                                minute: '2-digit' 
                              })}
                            </p>
                          </div>
                        </div>
                      ))}
                    </div>
                  </div>
                )}

                {showShareModal && (
                  <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
                    <div className="bg-white rounded-2xl p-6 max-w-md w-full">
                      <div className="flex items-center justify-between mb-4">
                        <h3 className="text-xl font-bold text-gray-800">Convidar Amigos</h3>
                        <button onClick={() => setShowShareModal(false)} className="text-gray-500 hover:text-gray-700">
                          <Icons.X size={24} />
                        </button>
                      </div>
                      
                      <p className="text-gray-600 mb-4">Compartilhe este código com seus amigos:</p>
                      
                      <div className="bg-gradient-to-r from-purple-100 to-blue-100 rounded-xl p-6 mb-4 text-center">
                        <p className="text-sm text-gray-600 mb-2">Código do Desafio</p>
                        <p className="text-3xl font-bold text-gray-800 tracking-wider break-all">
                          {challenge.id}
                        </p>
                      </div>
                      
                      <button
                        onClick={copyCode}
                        className={`w-full ${copied ? 'bg-green-500' : 'bg-gradient-to-r from-purple-500 to-blue-500'} text-white px-6 py-3 rounded-xl font-semibold hover:shadow-lg transition-all flex items-center justify-center gap-2`}
                      >
                        {copied ? <Icons.Check size={20} /> : <Icons.Copy size={20} />}
                        {copied ? 'Código Copiado!' : 'Copiar Código'}
                      </button>

                      <div className="mt-4 pt-4 border-t">
                        <p className="text-sm text-gray-500 mb-2 font-semibold">Como seus amigos podem entrar:</p>
                        <ol className="text-sm text-gray-600 space-y-1 list-decimal list-inside">
                          <li>Clique em "Entrar em um Desafio" na tela inicial</li>
                          <li>Cole o código acima</li>
                          <li>Pronto! Eles estarão no desafio 🎉</li>
                        </ol>
                      </div>
                    </div>
                  </div>
                )}
              </div>
            </div>
          );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>

</html>
